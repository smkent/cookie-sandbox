---
name: Update Dependencies

on:
  workflow_dispatch:

jobs:
  Update:
    name: Check for updates

    runs-on: ubuntu-latest

    steps:
      - name: 💾 Check out repository
        uses: actions/checkout@v3

      - name: 🐍 Build and test Python project with Poetry
        uses: ./.github/workflows/actions/python-poetry
        with:
          update: true

      - name: 🔬 Check if any dependencies were updated
        run: |
          echo "update_count=$(git status --porcelain | wc -l)" >> $GITHUB_ENV

      - name: ⚙️ Create pull request
        run: |
          echo update_count=${update_count}
        if: ${{ env.update_count > 0 }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
